## 第4章 变量、作用域与内存

>修炼，修心，修耐心。

- 1.ES6之后，JavaScript的变量声明经历了翻天覆地的变化。直到ECMAScript5.1，var都是声明变量的唯一关键字。ES6不仅增加了let和const两个关键字，而且还让这两个关键字压倒性地超越var成为首选。 --摘抄

- 2.如果变量未经声明就被初始化了，那么它就会自动被添加到全局上下文。 --摘抄

>也就是隐式声明。

- 3.未经声明而初始化变量是JavaScript编程中一个非常常见的错误，会导致很多问题。为此，读者在初始化变量之前一定要先声明变量。在严格模式下，未经声明就初始化变量会报错。 --摘抄

>就编程而言，在静态编译阶段能查出来越多错误越好，避免在运行阶段出错，而JS的一个缺点就是有些错误根本不能在静态编译阶段查出来，所以有了TypeScript，TypeScript还是很好很有用的。

- 4.var声明会被拿到函数或全局作用域的顶部，位于作用域中所有代码之前。这个现象叫作“提升”。提升让同一作用域中的代码不必考虑变量是否已经声明就可以直接使用。 --摘抄

- 5.ES6新增的let关键字跟var很相似，但它的作用域是块级的，这也是JavaScript中的新概念。块级作用域由最近的一对包含花括号{}界定。换句话说，if块、while块、function块，甚至连单独的块也是let声明变量的作用域。 --摘抄

- 6.let与var的另一个不同之处是在同一作用域内不能声明两次。重复的var声明会被忽略，而重复的let声明会抛出SyntaxError。 --摘抄

- 7.let的行为非常适合在循环中声明迭代变量。使用var声明的迭代变量会泄漏到循环外部。 --摘抄

- 8.严格来讲，let在JavaScript运行时中也会被提升，但由于“暂时性死区”的缘故，实际上不能在声明之前使用let变量。因此，从写JavaScript代码的角度说，let的提升跟var是不一样的。 --摘抄

- 9.使用const声明的变量必须同时初始化为某个值。一经声明，在其生命周期的任何时候都不能再重新赋予新值。 --摘抄

- 10.const除了遵守9的规则，其他方面与let声明式一样的。 --摘抄

- 11.赋值为对象的const变量不能再被重新赋值为其他引用值，但对象的键则不受限制。 --摘抄

- 12.如果想让整个对象都不能修改，可以使用Object.freeze()，这样再给属性赋值时虽然不会报错，但会静默失败。 --摘抄

- 13.由于const声明暗示变量的值是单一类型且不可修改，JavaScript运行时编译器可以将其所有实例都替换成实际的值，而不会通过查询表进行变量查找。谷歌的V8引擎就执行这种优化。 --摘抄

- 14.开发实践表明，如果开发流程并不会因此而受到很大影响，就应该尽可能地多使用const声明，除非确实需要一个将来会重新赋值的变量。这样可以从根本上保证提前发现重新赋值导致的bug。 --摘抄

- 15.作用域链中的对象也有一个原型链，因此搜索可能涉及每个对象的原型链。 --摘抄

- 16.使用块级作用域声明并不会改变搜索流程，但可以给词法层级添加额外的层级。 --摘抄

- 17.标识符查找并非没有代价。访问局部变量比访问全局变量要快，因为不用切换作用域。不过，JavaScript引擎在优化标识符查找上做了很多工作，将来这个差异可能就微不足道了。 --摘抄

- 18.JavaScript为开发者卸下了这个负担，通过自动内存管理实现内存分配和闲置资源回收。 --摘抄

- 19.确定哪个变量不会再使用，然后释放它占用的内存。这个过程是周期性的，即垃圾回收程序每隔一定时间（或者说在代码执行过程中某个预定的收集时间）就会自动运行。垃圾回收过程是一个近似且不完美的方案，因为某块内存是否还有用，属于“不可判定的”问题，意味着靠算法是解决不了的。 --摘抄

- 20.如何标记未使用的变量也许有不同的实现方式。不过，在浏览器的发展史上，用到过两种主要的标记策略：标记清理和引用计数。 --摘抄

- 21.JavaScript最常用的垃圾回收策略是标记清理。 --摘抄

- 总结：let和var的区别？TypeScript相对于JS的优点是什么？在开发过程中我们该不该遵循能用const就用const的原则？有哪些标记策略？JS最常用的垃圾回收策略是什么？

>1.var声明变量可重复定义，let不行。2.var存在声明提升，可在声明前使用，而let不行。3.var在全局作用域声明的变量会挂到window下面，而let不会，let其实是一个局部作用域。

>TypeScript可以减少在静态编译的时候出错的机率，由于JS是非常松散的，所以在静态编译的时候有些错误查不出来，导致有些错误会在运行中报出来，增加调试工作量，所以说有条件赶紧上TypeScript。

>是的，在开发过程中我们应该遵循能用const就尽量用const的原则。

>标记策略：标记清理和引用计数。

>JS最常用的垃圾回收策略是标记清理。
